<title>Kalkulator Toko</title>
<meta name='viewport' content='width=device-width, initial-scale=1, user-scalable=no'>

<style>
.isian {
width: 100%;
height: 10rem;
}
.tebal * {
font-weight: bold;
}
.miring * {
font-style: italic;
}
</style>

<form>
<textarea class='isian' placeholder='Contoh:
12 mini, 900, 4
20 bmx, 1000, 6'></textarea>
</form>

<table border='1'>
<tr class='tebal'>
<td>Barang</td>
<td>Harga</td>
<td>Jumlah</td>
<td>Total</td>
</tr>
<tbody class='isi'></tbody>
<tr class='miring'>
<td colspan='3'>Jumlah</td>
<td class='jumlah'>0</td>
</tr>
</table>

<script src='vendor/jquery/jquery.min.js'></script>
<script>
function matrix(list, elemen_per_sub_array){
    list_matrix = []
    i = 0
    k = 0
    for (i = 0, k = -1; i < list.length; i++){
        if (i % elemen_per_sub_array === 0){
            k++
            list_matrix[k] = []
        }
        list_matrix[k].push(list[i])
    }
    return list_matrix 
}

hitung = function(){
localStorage.setItem('kalkulator', $('.isian').val())
data = $('.isian').val().split(/[(\n)(,.)]/)
hasil = matrix(data, 3)
teks = ''
jumlah = []
for (n in hasil){
kali = Number(hasil[n][1]) * Number(hasil[n][2])
teks += '<tr><td>' + hasil[n][0] + '</td><td>' + Number(hasil[n][1]).toLocaleString('id') + '</td><td>' + Number(hasil[n][2]).toLocaleString('id') + '</td><td>' + kali.toLocaleString('id') + '</td></tr>'
jumlah.push(kali)
}
total_semua = 0
for (n in jumlah){
total_semua += jumlah[n]
}
$('.isi').html(teks)
$('.jumlah').html(total_semua.toLocaleString('id'))
}

$('.isian').on('keyup', function(){
hitung()
})
if (localStorage.getItem('kalkulator')){
$('.isian').val(localStorage.getItem('kalkulator'))
hitung()
}
</script>