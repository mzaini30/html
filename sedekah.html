<html>
<head>
	<title>Sedekah</title>
	<meta charset="utf-8">
	<meta name='viewport' content='width=device-width, initial-scale=1, user-scalable=no'>
	<style type="text/css">
		textarea {
			width: 100%;
			height: 10rem;
		}

		.tebal * {
			font-weight: bold;
		}
	</style>
</head>
<body>
	<form action="">
		<textarea class="isian"></textarea>
	</form>
	<table border="1">
		<tr>
			<td colspan="2">Banyak</td>
			<td class="banyak">0</td>
		</tr>
		<tr class="tebal">
			<td>Tertinggi</td>
			<td class="tertinggi">0</td>
			<td><meter min="0" max="100" value="100" class="meter_tertinggi"></meter></td>
		</tr>
		<tr>
			<td>Rata-Rata</td>
			<td class="rata_rata">0</td>
			<td><meter min="0" max="100" value="0" class="meter_rata_rata"></meter></td>
		</tr>
		<tr>
			<td colspan="3">&nbsp;</td>
		</tr>
		<tbody class="isi"></tbody>
	</table>
	<script type="text/javascript" src="vendor/jquery/jquery.min.js"></script>
	<script>
		ubah = function(){
			localStorage.setItem('sedekah', $('.isian').val())
			data = $('.isian').val().split('\n').reverse()
			tertinggi = 0
			for (n in data){
			    if (Number(data[n]) > Number(tertinggi)){
			        tertinggi = Number(data[n])
			    }
			}
			total = 0
			for (n in data){
			    total += Number(data[n])
			}
			rata2 = Number(total / data.length)
			hasil = ''
			data_baru = data.slice(0, 5)
			for (n in data_baru){
				hasil += '<tr><td colspan="2">' + Number(data_baru[n]).toLocaleString('id') + '</td><td><meter min="0" max="100" value="' + Math.floor(data[n]) / tertinggi * 100 + '"></meter></td></tr>'
			}
			$('.isi').html(hasil)
			$('.tertinggi').html(tertinggi.toLocaleString('id'))
			$('.rata_rata').html(Math.floor(rata2).toLocaleString('id'))
			$('.meter_rata_rata').attr('value', Math.floor(rata2 / tertinggi * 100))
			$('.banyak').html(data.length)
		}
		$('.isian').on('keyup', function(){
			ubah()
		})
		if (localStorage.getItem('sedekah')){
			$('.isian').val(localStorage.getItem('sedekah'))
			ubah()
		}
	</script>
</body>
</html>